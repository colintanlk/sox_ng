<html><head><title>Distro-AIX - sox_ng wiki</title></head>
<body><p align=center>sox_ng wiki - Distro-AIX</p>
<hr>
<h1 id="distroaix">Distro AIX</h1>

<p>AIX does not package SoX but has some peculiarities.</p>

<h2 id="builddependeencies">Build dependeencies</h2>

<p>On AIX 7.1, most of the build dependencies fail:</p>

<pre><code>configure.ac:9: warning: macro 'AM_DISABLE_STATIC' not found in library
configure.ac:36: warning: macro 'AM_PROG_LIBTOOL' not found in library
autom4te: need GNU m4 1.4 or later: /usr/bin/m4
</code></pre>

<p>even though I have the latest m4 installed in <code>~/bin</code> and <code>~/bin</code>
is the first in <code>$PATH</code>.</p>

<h3 id="libao">libao</h3>

<p><code>libao</code> fails with a compilation error in <code>src/ao_aix.c</code>.</p>

<p>The <a href="patches/libao-fix-on-AIX.patch">attached patch</a> fixes this in libao.</p>

<h3 id="file">file</h3>

<p><code>file</code> (for <code>libmagic</code>)&#8217;s <code>configure</code> fails saying it can&#8217;t find <code>pkg-config</code>.</p>

<p>With <code>pkg-config</code> installed, the build fails saying</p>

<pre><code>ld: ERROR: Undefined symbol: .getopt_long
</code></pre>

<p>which is odd because <code>file</code> correctly detects the lack of <code>getopt</code>,
has its own built-in <code>getopt_long</code> and <code>src/getopt_long.lo</code> is built.</p>

<h3 id="opusfile">opusfile</h3>

<p>Compilation fails saying</p>

<pre><code>rc/http.c: In function 'op_http_conn_start_tls':
src/http.c:1944:5: warning: ISO C forbids nested functions [-Wpedantic]
 1944 |         int                                ip_len;
            |         ^~~
In file included from /usr/include/netinet/tcp.h:115,
                                 from src/http.c:345:
src/http.c:1944:24: error: expected '=', ',', ';', 'asm' or '__attribute__' before '.' token
 1944 |         int                                ip_len;
src/http.c:1944:24: error: expected expression before '.' token
src/http.c:1949:5: error: 'ip_ff' undeclared (first use in this function); did you mean 'ip_fv'?
 1949 |         ip_len=0;
</code></pre>

<p>because <code>/usr/include/netinet/ip-h</code> contains</p>

<pre><code>#define    ip_len    ip_ff.ip_flen
</code></pre>

<p>The solution is to edit <code>src/http.c</code> to change all <code>ip_len</code> to <code>iplen</code>.</p>

<h3 id="libvorbis-1.3.7">libvorbis-1.3.7</h3>

<p><code>./configure --prefix=$HOME &amp;&amp; make</code> fails saying</p>

<pre><code>    CCLD         libvorbisfile.la
    ld: 0711-317 ERROR: Undefined symbol: .rintf
    ld: 0711-317 ERROR: Undefined symbol: .floor
</code></pre>

<p>but if you <code>autoreconf -i</code>, then <code>./configure &amp;&amp; make</code> works.</p>

<h2 id="extraction">Extraction</h2>

<ul>
<li>If the target directory <code>sox_ng-14.4.3</code> does not already exist, <code>tar</code> fails.</li>
</ul>

<h2 id="compilation">Compilation</h2>

<ul>
<li>On cfarm111, gcc is in /opt/freeware/bin so make sure that&#8217;s in your PATH.</li>
</ul>

<h2 id="installation">Installation</h2>

<ul>
<li>On AIX 7.1 <code>./configure --prefix=$HOME; make install</code> installs everything
under <code>$HOME/configure/</code> On AIX 7,3 it&#8217;s OK.</li>
</ul>
<hr>Generated by <tt>makehtml.sh</tt> on Sat Sep 14 08:24:28 PM CEST 2024</body>
